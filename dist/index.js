var dayOf = document.getElementById("to-Day"), dateOf = document.getElementById("to-Date"), formatDay = moment().format("dddd"), formatDate = moment().format("MMMM Do YYYY"); function getDay() { dayOf.textContent = formatDay, dateOf.textContent = formatDate } getDay(); var APIKey = "1d885c7bf9c1a3c6f39c0d44c2182d2f", queryURL = "", queryUV = "", city = document.getElementById("city"), longi = 0, lati = 0; function currentLocation() { navigator.geolocation ? (navigator.geolocation.getCurrentPosition(a => { lati = a.coords.latitude, longi = a.coords.longitude, queryURL = "https://api.openweathermap.org/data/2.5/weather?lat=" + lati + "&lon=" + longi + "&appid=" + APIKey, queryUV = "https://api.openweathermap.org/data/2.5/uvi?appid=1d885c7bf9c1a3c6f39c0d44c2182d2f&lat=" + lati + "&lon=" + longi, $.ajax({ url: queryURL, method: "GET" }).then(function (a) { city.textContent = a.name, console.log(a.name), $("#temperature").text("Temperature: " + Math.floor(1.8 * (a.main.temp - 273.15) + 32) + " F"), $("#humidity").text("Humidity: " + a.main.humidity + "%"), $("#wind").text("Wind: " + Math.floor(2.237 * a.wind.speed) + " mph") }), $.ajax({ url: queryUV, method: "GET" }).then(function (a) { var b = a.value; console.log(a), $("#vally").text(b) }) }), $.ajax({ url: "https://api.openweathermap.org/data/2.5/onecall?lat=" + lati + "&lon=" + longi + "&exclude=minutely,hourly&appid=1d885c7bf9c1a3c6f39c0d44c2182d2f", method: "GET" }).then(function (a) { for (var b = 1; 5 > b; b++)$("#forecast" + b + " #foredate").text(new Date(1e3 * a.daily[b].dt).toLocaleDateString("en-US")), $("#forecast" + b + " #foretemperature").text("Temeperature: " + Math.floor(1.8 * (a.daily[b].temp.max - 273.15) + 32) + "F"), $("#forecast" + b + " #forehumidity").text("Humidity: " + a.daily[b].humidity + "%"), $("#forecast" + b + " #foredesc").html("<img src=\"http://openweathermap.org/img/wn/" + a.daily[b].weather[0].icon + "@2x.png\">") })) : city.textContent = "location unknown." } currentLocation(), citySearch = [], $("#search").on("click", function (a) { console.log("search clicked"), a.preventDefault(); var b = $("#searchinfo").val(); console.log(b), citySearch.push(b), saveSearches(), displaySearches(), queryURL = "https://api.openweathermap.org/data/2.5/weather?q=" + b + "&appid=" + APIKey, $.ajax({ url: queryURL, method: "GET" }).then(function (a) { console.log(a), city.textContent = a.name, console.log(city.textContent), $("#temperature").text("Temperature: " + Math.floor(1.8 * (a.main.temp - 273.15) + 32) + "F"), $("#humidity").text("Humidity: " + a.main.humidity + "%"), $("#wind").text("Wind: " + Math.floor(2.237 * a.wind.speed) + "mph"), lati = a.coord.lat, longi = a.coord.lon, queryUV = "https://api.openweathermap.org/data/2.5/uvi?appid=1d885c7bf9c1a3c6f39c0d44c2182d2f&lat=" + lati + "&lon=" + longi, $.ajax({ url: queryUV, method: "GET" }).then(function (a) { ultra2 = a.value, $("#vally").empty(), $("#vally").text(ultra2) }), $.ajax({ url: "https://api.openweathermap.org/data/2.5/onecall?lat=" + lati + "&lon=" + longi + "&exclude=minutely,hourly&appid=95d5fa275b00b66c86cd3920c0de76f3", method: "GET" }).then(function (a) { for (var b = 1; 5 > b; b++)$("#forecast" + b + " #foredate").text(new Date(1e3 * a.daily[b].dt).toLocaleDateString("en-US")), $("#forecast" + b + " #foretemperature").text("Temeperature: " + Math.floor(1.8 * (a.daily[b].temp.max - 273.15) + 32) + "F"), $("#forecast" + b + " #forehumidity").text("Humidity: " + a.daily[b].humidity + "%") }) }) }), $(document).on("click", ".city-btn", function () { console.log("click me"); var a = $(this).text(); queryURL = "https://api.openweathermap.org/data/2.5/weather?q=" + a + "&appid=" + APIKey, $.ajax({ url: queryURL, method: "GET" }).then(function (a) { city.textContent = a.name, $("#temperature").text("Temperature: " + Math.floor(1.8 * (a.main.temp - 273.15) + 32) + "F"), $("#humidity").text("Humidity: " + a.main.humidity + "%"), $("#wind").text("Wind: " + Math.floor(2.237 * a.wind.speed) + "mph"), lati = a.coord.lat, longi = a.coord.lon, queryUV = "https://api.openweathermap.org/data/2.5/uvi?appid=1d885c7bf9c1a3c6f39c0d44c2182d2f&lat=" + lati + "&lon=" + longi, $.ajax({ url: queryUV, method: "GET" }).then(function (a) { $("#vally").text(a.value) }), $.ajax({ url: "https://api.openweathermap.org/data/2.5/onecall?lat=" + lati + "&lon=" + longi + "&exclude=minutely,hourly&appid=95d5fa275b00b66c86cd3920c0de76f3", method: "GET" }).then(function (a) { for (var b = 1; b = 5; b++)$("#forecast" + b + " #foredate").text(new Date(1e3 * a.daily[b].dt).toLocaleDateString("en-US")), $("#forecast" + b + " #foretemperature").text("Temeperature: " + Math.floor(1.8 * (a.daily[b].temp.max - 273.15) + 32) + "F"), $("#forecast" + b + " #forehumidity").text("Humidity: " + a.daily[b].humidity + "%") }) }) }); var citySearch = []; function displaySearches() { $("#buttons-view").empty(); for (var a, b = 0; b < citySearch.length; b++)a = $("<button>"), a.addClass("city-btn btn btn-primary btn-sm"), a.attr("data-name", citySearch[b]), a.text(citySearch[b]), $("#buttons-view").append(a) } function saveSearches() { localStorage.setItem("searches", JSON.stringify(citySearch)) } function init() { var a = JSON.parse(localStorage.getItem("searches")); null !== a && (citySearch = a), displaySearches() } init();